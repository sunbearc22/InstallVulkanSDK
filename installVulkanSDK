#!/bin/bash

# This is a script to install LunarG's VulkanSDK in Ubuntu 16.04.3
# Author      : sunbearc22
# Created on  : 2017-10-5
# Modified on : 2017-11-3  

echo
echo "============================================================"
echo "Program to locally install VulkanSDK in "$USER"'s directory."
echo "============================================================"
echo "Enter the version (e.g. 1.0.61.1) to be installed and press [ENTER]:"
read version
echo "Specify the Vulkan directory and path (e.g. ~/Vulkan) and press [ENTER]:"
read vpath
vpath="${vpath/#\~/$HOME}" #convert ~ to $HOME if ~ exist
dlpath="$HOME/Downloads/"
filename="vulkansdk-linux-x86_64-$version.run"
url="https://vulkan.lunarg.com/sdk/download/$version/linux/$filename?Human=true"
echo
echo "version  = " $version
echo "vpath    = " $vpath
echo "dlpath   = " $dlpath
echo "filename = " $filename
echo "url      = " $url

echo
echo "Step 1. Update and Upgrade System Packages"
sudo apt update
sudo apt dist-upgrade

echo
echo "Step2. Install Prerequisite Packages."
sudo apt install libglm-dev graphviz libxcb-dri3-0 libxcb-present0 libpciaccess0 cmake \
libpng-dev libxcb-dri3-dev libx11-dev libmirclient-dev libwayland-dev libxrandr-dev
#Packages to build shaderc
sudo apt install git libpython2.7
echo
echo "Step 3. Download Vulkan SDK Installer"
wget $url -O $dlpath$filename

echo
echo "Step 4. Set up Vulkan folder & Installer"
mkdir -p $vpath        #Create Vulkan directory if it doesn't exist
cd $vpath              #Goto Vulkan directory
cp $dlpath$filename ./ #Copy SDK to Vulkan directory
chmod ugo+x $filename  #Make SDK file executable 

echo
echo "Step 5. Installing Vulkan SDK"
./$filename

echo
echo "Step 6. Set up SDK Runtime Environment"
cd VulkanSDK/$version/
source setup-env.sh

echo
echo "Step 7. Verify Vulkan SDK Installation is successful."
#./x86_64/bin/vulkaninfo
vulkaninfo

echo
echo "Step 8. Build Vulkan examples, samples and tools."
./build_examples.sh
./build_samples.sh
./build_tools.sh

echo
echo "Step 9. Validate Vulkan Installation."
via

echo
echo "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"
echo "Vulkan SDK $version Installed!"
echo "Location: " $vpath"/VulkanSDK/"$version"/"
echo 
echo "To uninstall VulkanSDK, goto "$vpath
echo "and type 'rm -rf VulkanSDK' "
echo "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"


